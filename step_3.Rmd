---
title: "Chimera Removal"
---
```{css echo=FALSE}
code{
  white-space: pre !important;
  overflow-x: scroll !important;
  word-break: keep-all !important;
  word-wrap: initial !important;
}
```
<br>

`vsearch` is the primary tool we use for chimera detection and removal.
<br><br>

## 3.1 Dereplicating and Sorting Reads

There are still an enormous number of reads in our dataset. Many of these reads are identical. It doesn't make sense to analyze the same sequence repeatedly, so we concatenate the duplicate reads. `derep_fulllength` removes duplicate sequences and sorts the sequences by length. 

```{bash eval=FALSE}
$VSEARCH --threads 20 --derep_fulllength $DIR/quality_check/chimera_removal/all_combined_q$Q.fa --output $DIR/quality_check/chimera_removal/all_combined_q$Q\_unique_sort.fa --sizeout --minuniquesize 2
```
<br>

## 3.2 Chimera Detection

### De Novo

`uchime_denovo` evaluates each sequence without an outside reference base.

```{bash eval=FALSE}
$VSEARCH --threads 20 --uchime_denovo $DIR/quality_check/chimera_removal/all_combined_q$Q\_unique_sort.fa --chimeras $DIR/quality_check/chimera_removal/all_combined_q$Q\_unique_sort_denovo.chimera --nonchimeras $DIR/quality_check/chimera_removal/all_combined_q$Q\_unique_sort_denovo.good
```

### Reference

`uchime_ref` screens the selected chimera database for potential matches in your sequences.

```{bash eval=FALSE}
$VSEARCH --threads 20 --uchime_ref $DIR/quality_check/chimera_removal/all_combined_q$Q\_unique_sort_denovo.good --nonchimeras $DIR/quality_check/chimera_removal/all_combined_q$Q\_unique_sort_denovo_ref.good --db $CHIMERA_DB
```

## 3.3 Sort for Clustering

```{bash eval=FALSE}
$VSEARCH --threads 20 --derep_fulllength $DIRECTORY/quality_check/chimera_removal/all_combined_q$Q\_unique_sort_denovo_ref.good --relabel "U_" --output $DIRECTORY/quality_check/chimera_removal/relabeled_denovo_ref.good
```


